# 提权

## 权限提升

### 水平权限提升（越权）

同级权限

### 垂直权限提升

普通用户获得了管理员的权限

web用户直接提权成管理员用户


基于webshell的提权

- IIS的 aspx 木马
- asp    脚本权限比较低
         尝试上传aspx的大马

# windows提权

如果目标使用的是套件搭建的网站
phpstudy
xampp
wampserver

获取WebShell之后就是系统或管理员权限

宝塔
权限？ 安全防御比较高，禁用很多函数，考虑绕过

## 系统漏洞提权

找补丁，找漏洞，找EXP

  win2003
    信息收集
      PR 烤肉提权 MS09-012

可能会遇到的问题
1. 无法执行CMD命令
2. 无法上传提权exp
  目录写权限
    哪些目录必有写权限
      日志 缓存 大马所在目录
3. 在命令行开启3389端口
4. 如何创建windows 用户
 net user nhack 123.com /add
 net localgroup administrators hack /add

 数据库提权
   MSSQL
     xp_cmdshell  执行cmd命令
   前提，获取mssql sa的密码

 mysql提权
   利用mysql执行cmd 命令
   udf
   mof

## 第三方软件提权


反弹shell
  基于webshell 反弹shell
    建立一个持久性的连接

  命令解释器
  正向shell
    我主动连接服务器，服务器开启ssh端口
  反向shell 
    服务器主动连接我，我监听某一个端口
  
短文件名： 六个字符+~

  windows
    nc.exe 
  linux
    利用系统漏洞提权
      内核提权
    第三方软件
      套路比较多
        很难想象
        实战中体会
          dc系列
            靶机渗透
            提权操作

    收集系统信息
      unmae -a
    
    提权辅助脚本
      linux-exploit-suggester
      wget
      curl
    搜索漏洞库
      kali漏洞库
      searchsploit centos 7
      searchsploit -m 35370

      kali 中开启http服务
        python -m SimpleHTTPServer 8080

      运行提权脚本
        *$gcc exploit.c -o exploit -lpthread
        *$./exploit



# linux提权


# 提权

## 什么是提权

主要针对网站测试过程中，当测试某一网站时，通过各种漏洞提升WEBSHELL权限已夺得改服务器权限

## 通常脚本所处得权限

ASP\PHP 匿名权限(网络服务权限)
ASPX USER权限
jsp通常是系统权限

## 收集信息

内外网
服务器系统和版本位数
服务器得补丁情况
服务器得安装软件情况
服务器得防护软件情况
端口情况
支持脚本情况

## 信息收集常用命令

windows:
ipconfig/all 查看当前ip
net user 查看当前服务器账号情况
netstat -ano 查看当前服务器端口开放情况
ver 查看当前服务器操作系统
systeminfo 查看当前服务器配置信息(补丁情况)
tasklist /svc 查看当前服务器进程得情况
taskkill -PID pid号 结束某个pid号得进程
taskkill /im qq.exe /f 结束qq进程
net user cracer cracer /add 添加一个用户名为cracer密码为cracer的用户
net localgroup administrators cracer /add 将用户cracer添加到管理员组
whoami 查看当前操作用户(当前权限)

linux:
ls -al 查看当前目录下的文件和文件夹
pwd 查看当前操作路径
uname -a 查看当前服务器内核信息

## cmd命令执行

1. 防护软件拦截
2. cmd被降权
3. 组件被删除

找可读写目录上传cmd.exe，将执行的cmd.exe路径替换成上传的路径，再次调用执行

## windows提权



## linux提权

